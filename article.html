<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æ–‡ç« è©³æƒ… Â· æµèŠ¯è¦–è¦º</title>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4M94YE8ETT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4M94YE8ETT');
</script>

  <meta name="description" content="æµèŠ¯è¦–è¦º LYQD media æ–‡ç« è©³æƒ…é é¢">
  <meta name="keywords" content="æµèŠ¯è¦–è¦º,LYQD media,æ–‡ç« ,AI å½±åƒ,æ•¸ä½è¡ŒéŠ·,è¦–è¦ºè¨­è¨ˆ">
  
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Contentful API Configuration -->
  <script>
    // Contentful API é…ç½®
    const CONTENTFUL_CONFIG = {
      SPACE_ID: 'id4y90f1h82c',
      ACCESS_TOKEN: 'vxnpypRajiFP97o7gEfMoavejunX98K8undinDWuVbY',
      ENVIRONMENT: 'master',
      CONTENT_TYPE: 'pageBlogPost'
    };
    
    const CONTENTFUL_API_URL = `https://cdn.contentful.com/spaces/${CONTENTFUL_CONFIG.SPACE_ID}/environments/${CONTENTFUL_CONFIG.ENVIRONMENT}/entries`;
  </script>
  
  <link rel="stylesheet" href="css/style.css">
  
</head>
<body id="top" class="min-h-screen bg-white text-zinc-800 selection:bg-[#193a55]/30">




  <!-- ARTICLE CONTENT -->
  <main class="py-8 md:py-16">
    <div class="mx-auto max-w-4xl px-4">
      <!-- Loading State -->
      <div id="loading-state" class="text-center py-12">
        <div class="inline-flex items-center gap-3 text-zinc-600">
          <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-[#193a55]"></div>
          <span class="text-lg">æ­£åœ¨è¼‰å…¥æ–‡ç« ...</span>
        </div>
      </div>

      <!-- Error State -->
      <div id="error-state" class="hidden text-center py-12">
        <div class="text-zinc-600">
          <svg class="mx-auto h-16 w-16 text-zinc-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
          </svg>
          <p class="text-xl font-medium mb-2">è¼‰å…¥æ–‡ç« æ™‚ç™¼ç”ŸéŒ¯èª¤</p>
          <p class="text-sm mb-4">è«‹æª¢æŸ¥æ‚¨çš„ç¶²è·¯é€£ç·šæˆ–ç¨å¾Œå†è©¦</p>
          <button onclick="loadArticle()" class="inline-flex items-center justify-center rounded-full border border-black/20 px-6 py-2 text-sm font-medium hover:border-black/40 hover:bg-black/5 transition-all duration-200 text-zinc-800">
            é‡æ–°è¼‰å…¥
          </button>
        </div>
      </div>

      <!-- Article Container -->
      <div id="article-container" class="hidden">
        <!-- Article will be loaded here -->
      </div>

      <!-- Back to Blog Button -->
      <div class="mt-12 text-center">
        <a href="blog.html" class="inline-flex items-center gap-2 text-sm font-medium text-[#193a55] hover:text-[#0d1a2a] hover:underline transition-all duration-200">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          è¿”å›æ–‡ç« åˆ—è¡¨
        </a>
      </div>
    </div>
  </main>



  <script>
    // å¾ URL åƒæ•¸ç²å–æ–‡ç«  ID
    function getArticleId() {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get('id');
    }

    // ç²å–æ–‡ç« å…§å®¹
    async function fetchArticle(articleId) {
      try {
        const apiUrl = `${CONTENTFUL_API_URL}?sys.id=${articleId}&include=1`;
        const response = await fetch(apiUrl, {
          headers: { 'Authorization': `Bearer ${CONTENTFUL_CONFIG.ACCESS_TOKEN}` }
        });
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        const data = await response.json();
        return {
          article: data.items?.[0] || null,
          includes: data.includes || {}
        };
      } catch (error) {
        console.error('Error fetching article:', error);
        throw error;
      }
    }

    // æ¸²æŸ“å¯Œæ–‡æœ¬å…§å®¹ (ä½¿ç”¨å®˜æ–¹å‡½å¼åº«ï¼Œä¸¦æ¥æ”¶ assetMap)
    function renderRichText(richTextDocument, assetMap) {
      if (!richTextDocument) return 'å…§å®¹è¼‰å…¥ä¸­...';
      
      // æª¢æŸ¥å¤šå€‹å¯èƒ½çš„ç‰©ä»¶åç¨±
      const renderer = window.contentfulRichText || window.richTextHtmlRenderer || window.richTextRenderer;
      if (!renderer) {
        console.error('âŒ æ‰¾ä¸åˆ° Contentful Rich Text Renderer å‡½å¼åº«');
        return '<p>æ¸²æŸ“å·¥å…·è¼‰å…¥å¤±æ•—ï¼Œè«‹é‡æ–°æ•´ç†é é¢</p>';
      }
      
      const options = {
        renderNode: {
          'embedded-asset-block': (node) => {
            const assetId = node.data?.target?.sys?.id;
            if (!assetId) return '';
            const asset = assetMap.get(assetId);
            if (asset && asset.fields && asset.fields.file) {
              return `<figure class="my-6"><img src="https:${asset.fields.file.url}" alt="${asset.fields.description || ''}" class="mx-auto rounded-lg shadow-lg" /><figcaption class="text-center text-sm text-zinc-500 mt-2">${asset.fields.description || ''}</figcaption></figure>`;
            }
            return '';
          },
          'blockquote': (node, next) => `<blockquote>${next(node.content)}</blockquote>`
        }
      };
      
      try {
        return renderer.documentToHtmlString(richTextDocument, options);
      } catch (error) {
        console.error('âŒ æ¸²æŸ“å¯Œæ–‡æœ¬æ™‚ç™¼ç”ŸéŒ¯èª¤:', error);
        return '<p>å…§å®¹æ¸²æŸ“å¤±æ•—ï¼Œè«‹é‡æ–°æ•´ç†é é¢</p>';
      }
    }

    // æ¸²æŸ“æ–‡ç« å…§å®¹
    function renderArticle(article, assetMap) {
      const fields = article.fields;
      let heroImage = '';
      let imageUrl = null;
      if (fields.featuredImage?.sys?.id) {
        const asset = assetMap.get(fields.featuredImage.sys.id);
        if (asset?.fields?.file?.url) {
          imageUrl = `https:${asset.fields.file.url}`;
        }
      }
      if (imageUrl) {
        heroImage = `<div class="mb-8"><img src="${imageUrl}" alt="${fields.title || 'æ–‡ç« ç‰¹è‰²åœ–ç‰‡'}" class="w-full h-64 md:h-96 object-cover rounded-2xl shadow-lg" /></div>`;
      }
      const publishDate = fields.publishDate ? new Date(fields.publishDate).toLocaleDateString('zh-TW', { year: 'numeric', month: 'long', day: 'numeric' }) : 'è¿‘æœŸ';
      const category = fields.category || fields.tags?.[0] || 'æœªåˆ†é¡';
      let content = 'æ–‡ç« å…§å®¹è¼‰å…¥ä¸­...';
      if (fields.content?.content) {
        content = renderRichText(fields.content, assetMap);
      } else if (fields.body) {
        content = renderRichText(fields.body, assetMap);
      }
      return `<article>${heroImage}<header class="mb-8"><div class="flex items-center gap-3 text-sm text-zinc-500 mb-4"><span class="px-3 py-1 bg-zinc-100 rounded-full">${category}</span><span>â€¢</span><span>${publishDate}</span></div><h1 class="text-3xl md:text-4xl font-bold text-zinc-900 mb-4">${fields.title || 'ç„¡æ¨™é¡Œ'}</h1>${fields.excerpt ? `<p class="text-lg text-zinc-600 leading-relaxed">${fields.excerpt}</p>` : ''}</header><div class="article-content prose prose-lg max-w-none">${content}</div></article>`;
    }

    // é¡¯ç¤ºéŒ¯èª¤ç‹€æ…‹çš„è¼”åŠ©å‡½æ•¸
    function showError(message) {
      const errorState = document.getElementById('error-state');
      const loadingState = document.getElementById('loading-state');
      const articleContainer = document.getElementById('article-container');
      if (errorState && loadingState) {
        loadingState.classList.add('hidden');
        articleContainer.classList.add('hidden');
        errorState.classList.remove('hidden');
        errorState.querySelector('p:last-of-type').textContent = `éŒ¯èª¤è©³æƒ…: ${message}`;
      }
    }

    // è¼‰å…¥æ–‡ç« ä¸»å‡½æ•¸
    async function loadArticle() {
      const articleId = getArticleId();
      if (!articleId) {
        showError('ç¼ºå°‘æ–‡ç«  ID åƒæ•¸');
        return;
      }
      try {
        const loadingState = document.getElementById('loading-state');
        const articleContainer = document.getElementById('article-container');
        loadingState.classList.remove('hidden');
        articleContainer.classList.add('hidden');
        const result = await fetchArticle(articleId);
        if (!result.article) {
          throw new Error(`æ‰¾ä¸åˆ° ID ç‚º "${articleId}" çš„æ–‡ç« ã€‚`);
        }
        const assetMap = new Map();
        (result.includes?.Asset || []).forEach(asset => assetMap.set(asset.sys.id, asset));
        const articleHTML = renderArticle(result.article, assetMap);
        loadingState.classList.add('hidden');
        articleContainer.innerHTML = articleHTML;
        articleContainer.classList.remove('hidden');
        document.title = `${result.article.fields.title || 'æ–‡ç« è©³æƒ…'} Â· æµèŠ¯è¦–è¦º`;
      } catch (error) {
        console.error('Error loading article:', error);
        showError(error.message);
      }
    }

    // ç¢ºä¿é é¢æ‰€æœ‰è³‡æº (åŒ…å«å¤–éƒ¨è…³æœ¬) è¼‰å…¥å®Œæˆå¾Œï¼Œæ‰è‡ªå‹•è¼‰å…¥æ–‡ç« 
    window.onload = function() {
      console.log('ğŸ” æª¢æŸ¥ Contentful Rich Text Renderer å‡½å¼åº«...');
      
      // æª¢æŸ¥å¤šå€‹å¯èƒ½çš„ç‰©ä»¶åç¨±
      const renderer = window.contentfulRichText || window.richTextHtmlRenderer || window.richTextRenderer;
      
      console.log('window.contentfulRichText:', window.contentfulRichText);
      console.log('window.richTextHtmlRenderer:', window.richTextHtmlRenderer);
      console.log('window.richTextRenderer:', window.richTextRenderer);
      console.log('æ‰¾åˆ°çš„ renderer:', renderer);
      
      if (!renderer) {
        console.error('âŒ æ‰€æœ‰å¯èƒ½çš„æ¸²æŸ“å·¥å…·éƒ½æœªè¼‰å…¥ï¼');
        showError('æ ¸å¿ƒæ¸²æŸ“å·¥å…·è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·šæˆ–é‡æ–°æ•´ç†é é¢ã€‚');
        return;
      }
      
      console.log('âœ… æ¸²æŸ“å·¥å…·è¼‰å…¥æˆåŠŸï¼é–‹å§‹è¼‰å…¥æ–‡ç« ...');
      loadArticle();
    };
  </script>

  <!-- Contentful Rich Text Renderer (UMD ç‰ˆæœ¬) -->
  <script src="https://unpkg.com/@contentful/rich-text-html-renderer/dist/rich-text-html-renderer.umd.js"></script>
  
  <!-- å¼•å…¥å…±ç”¨ JavaScript åŠŸèƒ½ -->
  <!-- å¼•å…¥å…±ç”¨çµ„ä»¶ç³»çµ± -->
  <script src="js/components.js"></script>
  
  <script src="js/main.js"></script>
</body>
</html>
