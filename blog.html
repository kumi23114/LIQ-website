<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>文章專欄 · 流芯視覺</title>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4M94YE8ETT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4M94YE8ETT');
</script>

  <meta name="description" content="流芯視覺 LYQD media 文章專欄，分享 AI 影像製作、數位行銷、視覺設計等相關專業知識與產業趨勢。">
  <meta name="keywords" content="流芯視覺,LYQD media,文章專欄,AI 影像,數位行銷,視覺設計,產業趨勢">
  
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Contentful API Configuration (Proxy) -->
  <script>
    const CONTENTFUL_CONTENT_TYPE = 'pageBlogPost';
    // 透過自家 proxy 呼叫 Contentful，避免前端暴露金鑰
    function contentfulProxyUrl(params) {
      const search = new URLSearchParams(params).toString();
      return `/api/contentful?path=/entries&${search}`;
    }
  </script>
  
  <link rel="stylesheet" href="css/style.css">
</head>
<body id="top" class="min-h-screen bg-white text-zinc-800 selection:bg-[#193a55]/30">
  <!-- NAV -->
  <header class="sticky top-0 z-40 border-b border-black/5 bg-white/70 backdrop-blur">
    <div class="mx-auto flex max-w-7xl items-center justify-between px-4 py-4">
      <a href="index.html#top" class="group inline-flex items-center gap-3 transition-all duration-300 hover:scale-105">
        <div class="h-8 w-8 rounded-sm shadow-[0_0_30px_rgba(25,58,85,.35)] transition-all duration-300 group-hover:shadow-[0_0_40px_rgba(25,58,85,.5)]" style="background:linear-gradient(135deg, rgba(25,58,85,1) 0%, rgba(13,29,43,1) 100%)"></div>
        <span class="font-semibold tracking-wide text-zinc-800 transition-colors duration-300 group-hover:text-[#193a55]">流芯視覺</span>
      </a>
      <nav class="hidden gap-8 md:flex">
        <a href="index.html#showreel" class="nav-link text-sm text-zinc-600 hover:text-zinc-800 relative overflow-hidden transition-all duration-300">
          <span class="relative z-10">精選作品集</span>
          <span class="nav-underline"></span>
        </a>
        <a href="index.html#advantages" class="nav-link text-sm text-zinc-600 hover:text-zinc-800 relative overflow-hidden transition-all duration-300">
          <span class="relative z-10">關於我們</span>
          <span class="nav-underline"></span>
        </a>
        <a href="index.html#cases" class="nav-link text-sm text-zinc-600 hover:text-zinc-800 relative overflow-hidden transition-all duration-300">
          <span class="relative z-10">AI應用項目</span>
          <span class="nav-underline"></span>
        </a>
        <a href="index.html#process" class="nav-link text-sm text-zinc-600 hover:text-zinc-800 relative overflow-hidden transition-all duration-300">
          <span class="relative z-10">服務流程</span>
          <span class="nav-underline"></span>
        </a>
        <a href="faq.html" class="nav-link text-sm text-zinc-600 hover:text-zinc-800 relative overflow-hidden transition-all duration-300">
          <span class="relative z-10">常見問題</span>
          <span class="nav-underline"></span>
        </a>
        <a href="blog.html" class="nav-link active text-sm text-zinc-800 relative overflow-hidden transition-all duration-300">
          <span class="relative z-10">文章專欄</span>
          <span class="nav-underline"></span>
        </a>
      </nav>
      <a href="index.html#contact" class="hidden rounded-full px-4 py-2 text-sm font-semibold md:inline-flex hover:shadow-[0_0_30px_rgba(25,58,85,.5)] hover:-translate-y-0.5 transition-all duration-200 active:scale-95" style="background-color:#193a55;color:white">預約諮詢</a>
    </div>
  </header>

  <!-- Mobile Navigation Bar -->
  <div class="md:hidden mobile-nav-container">
    <!-- Mobile Header with Burger Menu -->
    <div class="mobile-header">
      <div class="burger-container" onclick="toggleMobileMenu()">
        <div id="burger">
          <div class="bar topBar"></div>
          <div class="bar btmBar"></div>
        </div>
      </div>
      
      <div class="mobile-logo">
        <span class="font-semibold tracking-wide text-white">流芯視覺</span>
      </div>
      
      <div class="mobile-cta">
        <a href="index.html#contact" class="mobile-cta-btn">諮詢</a>
      </div>
    </div>
    
    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay">
      <!-- Close button (X) -->
      <button class="mobile-menu-close" onclick="closeMobileMenu()" aria-label="關閉選單">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      
      <ul class="mobile-menu">
        <li class="mobile-menu-item">
          <a href="index.html#top">首頁</a>
        </li>
        <li class="mobile-menu-item">
          <a href="index.html#showreel">精選作品集</a>
        </li>
        <li class="mobile-menu-item">
          <a href="index.html#advantages">關於我們</a>
        </li>
        <li class="mobile-menu-item">
          <a href="index.html#cases">AI應用項目</a>
        </li>
        <li class="mobile-menu-item">
          <a href="index.html#process">服務流程</a>
        </li>
        <li class="mobile-menu-item">
          <a href="faq.html">常見問題</a>
        </li>
        <li class="mobile-menu-item">
          <a href="blog.html">文章專欄</a>
        </li>
      </ul>
    </div>
  </div>

  <!-- HERO SECTION -->
  <section class="relative isolate overflow-hidden py-16 md:py-24">
    <div class="grain pointer-events-none absolute inset-0" aria-hidden="true"></div>
    <div class="relative mx-auto max-w-4xl px-4 text-center">
      <h1 class="text-pretty text-4xl font-semibold tracking-wide md:text-6xl text-zinc-900">文章專欄</h1>
      <p class="mt-6 max-w-2xl mx-auto text-zinc-600 text-lg">分享 AI 影像製作、數位行銷與視覺設計的專業見解</p>
    </div>
  </section>

  <!-- BLOG SECTION -->
  <section class="border-t border-black/5 py-14 md:py-20 bg-zinc-100">
    <div class="mx-auto max-w-7xl px-4">
      <!-- Section Header -->
      <div class="mb-16 text-center">
        <div class="inline-flex items-center justify-center mb-4">
          <span class="mr-3 inline-block h-3 w-12 -translate-y-1 rounded-full" style="background-color:#193a55"></span>
        </div>
      </div>

      <!-- Article Grid -->
      <div id="articles-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        <!-- 文章將由 JavaScript 動態載入 -->
      </div>
      
      <!-- Loading State -->
      <div id="loading-state" class="text-center py-12">
        <div class="inline-flex items-center gap-3 text-zinc-600">
          <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-[#193a55]"></div>
          <span>正在載入文章...</span>
        </div>
      </div>
      
      <!-- Error State -->
      <div id="error-state" class="hidden text-center py-12">
        <div class="text-zinc-600">
          <svg class="mx-auto h-12 w-12 text-zinc-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
          </svg>
          <p class="text-lg font-medium mb-2">載入文章時發生錯誤</p>
          <p class="text-sm mb-4">請檢查您的網路連線或稍後再試</p>
          <button onclick="loadBlogPosts()" class="inline-flex items-center justify-center rounded-full border border-black/20 px-6 py-2 text-sm font-medium hover:border-black/40 hover:bg-black/5 transition-all duration-200 text-zinc-800">
            重新載入
          </button>
        </div>
      </div>
      
      <!-- No Articles State -->
      <div id="no-articles-state" class="hidden text-center py-12">
        <div class="text-zinc-600">
          <svg class="mx-auto h-12 w-12 text-zinc-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path>
          </svg>
          <p class="text-lg font-medium mb-2">目前沒有文章</p>
          <p class="text-sm">請稍後再來查看</p>
        </div>
      </div>

      <!-- Load More Button -->
      <div class="mt-16 text-center">
        <button id="load-more-btn" onclick="loadMorePosts()" class="inline-flex items-center justify-center rounded-full border border-black/20 px-8 py-3 text-sm font-semibold hover:border-black/40 hover:bg-black/5 hover:shadow-md hover:-translate-y-0.5 transition-all duration-200 text-zinc-800">
          載入更多文章
        </button>
      </div>
    </div>
  </section>

  <!-- NEWSLETTER SECTION -->
  <section class="border-t border-black/5 py-16 md:py-24">
    <div class="mx-auto max-w-3xl px-4 text-center">
      <h2 class="text-pretty text-3xl font-semibold md:text-5xl text-zinc-900">訂閱最新文章</h2>
      <p class="mx-auto mt-4 max-w-2xl text-zinc-600">第一時間獲得 AI 影像製作與數位行銷的最新見解</p>
      <form class="mt-8 flex flex-col sm:flex-row gap-4 max-w-md mx-auto" onsubmit="handleNewsletter(event)">
        <input type="email" name="email" placeholder="您的 Email 地址" required class="flex-1 rounded-full border border-black/20 bg-white px-4 py-3 text-sm outline-none ring-0 placeholder:text-zinc-500 focus:border-black/30" />
        <button type="submit" class="inline-flex items-center justify-center rounded-full px-6 py-3 text-sm font-semibold shadow-[0_0_40px_rgba(25,58,85,.35)] hover:shadow-[0_0_50px_rgba(25,58,85,.5)] hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-[#193a55] transition-all duration-200" style="background-color:#193a55;color:white">訂閱</button>
      </form>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="border-t border-black/5 py-10">
    <div class="mx-auto flex max-w-7xl flex-col items-center justify-between gap-6 px-4 text-sm text-zinc-600 md:flex-row">
      <p>LYQD Media · 電影級 AI 製作</p>
      <div class="flex items-center gap-6">
        <a href="index.html#showreel" class="hover:text-zinc-800">精選作品集</a>
        <a href="index.html#cases" class="hover:text-zinc-800">AI應用項目</a>
        <a href="index.html#contact" class="hover:text-zinc-800">聯絡我們</a>
        <a href="blog.html" class="hover:text-zinc-800">文章專欄</a>
      </div>
    </div>
  </footer>

  <!-- Sticky CTA Buttons -->
  <div class="sticky-cta">
    <!-- 取得報價按鈕 -->
    <button class="sticky-cta-button primary" onclick="openMiniContact()" title="取得報價">
      💰
      <span class="tooltip">取得報價</span>
    </button>
    
    <!-- LINE 官方帳號按鈕 -->
    <a href="https://lin.ee/0eBvgAV" target="_blank" class="sticky-cta-button secondary" title="LINE 官方帳號">
      💬
      <span class="tooltip">LINE 官方帳號</span>
    </a>
  </div>

  <!-- Mini Contact Form Modal -->
  <div id="miniContactModal" class="mini-contact-modal">
    <div class="mini-contact-content">
      <button class="mini-contact-close" onclick="closeMiniContact()">&times;</button>
      
      <div class="mini-contact-header">
        <h3>取得報價</h3>
        <p>留下資訊，我們將在 24 小時內回覆</p>
      </div>
      
      <form class="mini-contact-form" action="https://formspree.io/f/mdkdqdqp" method="POST" enctype="text/plain">
        <input type="text" name="Name" placeholder="您的姓名" required>
        <input type="email" name="Email" placeholder="您的 Email" required>
        <textarea name="Message" placeholder="簡述您的專案內容、時程與預算區間" required></textarea>
        
        <div class="mini-contact-actions">
          <button type="submit" class="submit-btn">送出</button>
          <button type="button" class="cancel-btn" onclick="closeMiniContact()">取消</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // Newsletter subscription handler
    function handleNewsletter(event) {
      event.preventDefault();
      const email = event.target.email.value;
      
      // Simple validation
      if (!email || !email.includes('@')) {
        alert('請輸入有效的 Email 地址');
        return;
      }
      
      // Here you would typically send the email to your server
      // For now, just show a success message
      alert('感謝您的訂閱！我們會定期發送最新文章給您。');
      event.target.reset();
    }





    // Contentful API 相關函數（透過後端代理）
    async function fetchBlogPosts(limit = 6, skip = 0) {
      try {
        const proxyUrl = contentfulProxyUrl({
          content_type: CONTENTFUL_CONTENT_TYPE,
          order: '-sys.createdAt',
          limit: String(limit),
          skip: String(skip),
          include: '1'
        });

        const response = await fetch(proxyUrl);

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        console.log('Contentful API Response:', data); // 調試信息
        return {
          items: data.items || [],
          total: data.total || 0,
          includes: data.includes || {}
        };
      } catch (error) {
        console.error('Error fetching blog posts:', error);
        throw error;
      }
    }

    // 渲染文章卡片
    function renderBlogPost(article, assetMap) {
      const fields = article.fields;
      
      // 處理圖片 - 使用 Asset Map 模式
      let imageUrl = 'https://images.unsplash.com/photo-1518558400203-08fa1b3c85be?q=80&w=800&auto=format&fit=crop'; // 預設圖片
      
      // 調試：記錄文章的所有欄位
      console.log(`Article "${fields.title || '無標題'}" fields:`, fields);
      
      // 使用 Asset Map 查找圖片資源
      if (fields.featuredImage && fields.featuredImage.sys && fields.featuredImage.sys.id) {
        const assetId = fields.featuredImage.sys.id;
        const asset = assetMap.get(assetId);
        
        if (asset && asset.fields && asset.fields.file && asset.fields.file.url) {
          imageUrl = `https:${asset.fields.file.url}`;
          console.log(`✅ 從 Asset Map 找到圖片: ${imageUrl}`);
        } else {
          console.log(`⚠️ Asset Map 中未找到 ID 為 ${assetId} 的圖片資源`);
        }
      } else {
        console.log(`⚠️ 文章中未找到 featuredImage 的 sys.id`);
        console.log(`featuredImage 欄位:`, fields.featuredImage);
      }
      
      // 處理日期
      const publishDate = fields.publishDate ? new Date(fields.publishDate).toLocaleDateString('zh-TW', {
        year: 'numeric',
        month: 'long'
      }) : '近期';
      
      // 處理分類
      const category = fields.category || fields.tags?.[0] || '未分類';
      
      // 處理摘要
      let excerpt = '點擊閱讀更多...';
      if (fields.excerpt) {
        excerpt = fields.excerpt;
      } else if (fields.description) {
        excerpt = fields.description;
      } else if (fields.content && fields.content.content && fields.content.content[0] && fields.content.content[0].content && fields.content.content[0].content[0] && fields.content.content[0].content[0].value) {
        excerpt = fields.content.content[0].content[0].value.substring(0, 100) + '...';
      }
      
      // 生成文章連結 - 統一使用 sys.id 確保唯一性和一致性
      const articleUrl = `article.html?id=${article.sys.id}`;
      
      // 調試信息：記錄文章 ID 和連結
      console.log(`Article "${fields.title || '無標題'}": ID=${article.sys.id}, URL=${articleUrl}`);
      
      return `
        <article class="group overflow-hidden rounded-2xl border border-black/10 bg-white shadow-md hover:border-black/20 hover:shadow-lg hover:-translate-y-1 transition-all duration-300">
          <div class="relative aspect-video overflow-hidden">
            <img src="${imageUrl}" alt="${fields.title || '文章圖片'}" class="h-full w-full object-cover transition group-hover:scale-105" onerror="console.error('圖片載入失敗:', this.src); this.src='https://images.unsplash.com/photo-1518558400203-08fa1b3c85be?q=80&w=800&auto=format&fit=crop'" onload="console.log('圖片載入成功:', this.src)" />
            <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-black/60"></div>
          </div>
          <div class="p-6">
            <div class="flex items-center gap-3 text-xs text-zinc-500 mb-3">
              <span>${category}</span>
              <span>•</span>
              <span>${publishDate}</span>
            </div>
            <h4 class="font-semibold mb-3 group-hover:text-[#193a55] transition-colors text-zinc-900">
              ${fields.title || '無標題'}
            </h4>
            <p class="text-sm text-zinc-600 mb-4 line-clamp-3">
              ${excerpt}
            </p>
            <a href="${articleUrl}" class="text-sm font-medium text-[#193a55] hover:text-[#0d1a2a] hover:underline transition-all duration-200">閱讀更多</a>
          </div>
        </article>
      `;
    }

    // 載入並顯示文章
    async function loadBlogPosts() {
      const articlesContainer = document.getElementById('articles-container');
      const loadingState = document.getElementById('loading-state');
      const errorState = document.getElementById('error-state');
      const noArticlesState = document.getElementById('no-articles-state');
      
      try {
        // 顯示載入狀態
        loadingState.classList.remove('hidden');
        errorState.classList.add('hidden');
        noArticlesState.classList.add('hidden');
        articlesContainer.innerHTML = '';
        
        // 獲取文章
        const result = await fetchBlogPosts(6, 0);
        
        // 隱藏載入狀態
        loadingState.classList.add('hidden');
        
        if (result.items.length === 0) {
          // 顯示無文章狀態
          noArticlesState.classList.remove('hidden');
        } else {
          // 建立 Asset Map 以便快速查找圖片資源
          const assets = result.includes?.Asset || [];
          const assetMap = new Map();
          
          assets.forEach(asset => {
            if (asset.sys && asset.sys.id) {
              assetMap.set(asset.sys.id, asset);
            }
          });
          
          console.log(`建立 Asset Map，包含 ${assetMap.size} 個圖片資源`);
          
          // 渲染文章，傳遞 assetMap 參數
          const articlesHTML = result.items.map(article => renderBlogPost(article, assetMap)).join('');
          articlesContainer.innerHTML = articlesHTML;
          
          // 更新載入更多按鈕狀態
          updateLoadMoreButton(result.total, result.items.length);
        }
    } catch (error) {
      console.error('Error loading blog posts:', error);
      
      // 隱藏載入狀態
      loadingState.classList.add('hidden');
      
      // 顯示錯誤狀態
      errorState.classList.remove('hidden');
      
      // 在錯誤狀態中顯示具體錯誤信息
      const errorMessage = errorState.querySelector('p:last-of-type');
      if (errorMessage) {
        errorMessage.textContent = `錯誤詳情: ${error.message}`;
      }
    }
  }

  // （已移除）調試函數：由於改經過代理，此函數不再使用

  // 載入更多文章
  let currentSkip = 6;
  async function loadMorePosts() {
    const loadMoreBtn = document.getElementById('load-more-btn');
    const articlesContainer = document.getElementById('articles-container');
    
    try {
      // 顯示載入狀態
      loadMoreBtn.innerHTML = `
        <div class="inline-flex items-center gap-2">
          <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-current"></div>
          載入中...
        </div>
      `;
      loadMoreBtn.disabled = true;
      
      // 獲取更多文章
      const result = await fetchBlogPosts(6, currentSkip);
      
      if (result.items.length > 0) {
        // 建立 Asset Map 以便快速查找圖片資源
        const assets = result.includes?.Asset || [];
        const assetMap = new Map();
        
        assets.forEach(asset => {
          if (asset.sys && asset.sys.id) {
            assetMap.set(asset.sys.id, asset);
          }
        });
        
        console.log(`載入更多文章時建立 Asset Map，包含 ${assetMap.size} 個圖片資源`);
        
        // 添加新文章到現有容器，傳遞 assetMap 參數
        const newArticlesHTML = result.items.map(article => renderBlogPost(article, assetMap)).join('');
        articlesContainer.insertAdjacentHTML('beforeend', newArticlesHTML);
        
        // 更新計數器
        currentSkip += result.items.length;
        
        // 更新載入更多按鈕狀態
        updateLoadMoreButton(result.total, currentSkip);
      } else {
        // 沒有更多文章
        loadMoreBtn.style.display = 'none';
      }
    } catch (error) {
      console.error('Error loading more posts:', error);
      alert('載入更多文章時發生錯誤，請稍後再試');
      
      // 恢復按鈕狀態
      loadMoreBtn.innerHTML = '載入更多文章';
      loadMoreBtn.disabled = false;
    }
  }

  // 更新載入更多按鈕狀態
  function updateLoadMoreButton(total, current) {
    const loadMoreBtn = document.getElementById('load-more-btn');
    
    if (current >= total) {
      // 已載入所有文章
      loadMoreBtn.style.display = 'none';
    } else {
      // 還有更多文章可以載入
      loadMoreBtn.style.display = 'inline-flex';
      loadMoreBtn.innerHTML = '載入更多文章';
      loadMoreBtn.disabled = false;
    }
  }



    // 頁面載入完成後自動載入文章
    document.addEventListener('DOMContentLoaded', function() {
      // 透過代理直接載入文章
      loadBlogPosts();
    });
  </script>

  <!-- 引入共用 JavaScript 功能 -->
  <script src="js/main.js"></script>
</body>
</html>

